<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
    <link rel="stylesheet" href="../src/leaflet-search.css" />
    <script src='https://api.mapbox.com/mapbox.js/v2.2.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v2.2.1/mapbox.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
<link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />

    <link rel="stylesheet" href="Print/dist/easyPrint.css"/>
   <link rel="stylesheet" href="mylocation/dist/L.Control.Locate.min.css" />
   <link rel="stylesheet" href="mylocation/style.css" />
   <link rel="stylesheet" href="legend/src/leaflet-panel-layers.css" />
   <link rel="stylesheet" href="legend/icons.css" />
   <link rel="stylesheet" href="sidebar/css/leaflet-sidebar.css" />
   <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <!--<link 
        rel="stylesheet" 
        href="http://k4r573n.github.io/leaflet-control-osm-geocoder/Control.OSMGeocoder.css"
    />-->
    <style>
      .gitButton{padding:15px 30px; background-color: #47a230;text-decoration: none;font-weight: 900; color: white; text-transform:uppercase; transition: background-color .5s;}
.gitButton:hover {background-color: #1d7806}
.gitButton:visited {color: white;}
    body {
      
      /*background:url('sky.jpg');*/
      
      background-repeat: repeat;
      
      right: 200px;
      color:#021;
      font: "Helvetica Neue", Arial, Helvetica, sans-serif;;
    }
      #map {
            position: absolute;
            top:100px;
            left: 20px;
            right: 0;
            bottom:5px;
      }
      #findbox {
        background: #fff;
        border-radius:.125em;
         
        top:20px;
        margin-bottom: 10px;
        padding: 2px 0;
        width: 220px;
        height: 26px;
        border-style:solid;border-width:1px;border-color:#d3d3d3;border-left:2px;-moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;-moz-box-shadow:2px 2px 2px -2px gray;-webkit-box-shadow:2px 2px 2px -2px gray;box-shadow:2px 2px 2px -2px gray
        
      }
      #findbox2 {
        background: #fff;
        border-radius:.125em;
         
        top:20px;
        margin-bottom: 10px;
        padding: 2px 0;
        width: 220px;
        height: 26px;
        border-style:solid;border-width:1px;border-color:#d3d3d3;border-left:2px;-moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;-moz-box-shadow:2px 2px 2px -2px gray;-webkit-box-shadow:2px 2px 2px -2px gray;box-shadow:2px 2px 2px -2px gray
        
      }
      #findbox3 {
        background: #fff;
        border-radius:.125em;
         
        top:20px;
        margin-bottom: 10px;
        padding: 2px 0;
        width: 220px;
        height: 26px;
        border-style:solid;border-width:1px;border-color:#d3d3d3;border-left:2px;-moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;-moz-box-shadow:2px 2px 2px -2px gray;-webkit-box-shadow:2px 2px 2px -2px gray;box-shadow:2px 2px 2px -2px gray
        
      }

      #findbox_from {
        background: #fff;
        border-radius:.125em;
         
        top:50px;
        margin-bottom: 10px;
        padding: 2px 0;
        width: 220px;
        height: 26px;
        border-style:solid;border-width:1px;border-color:#d3d3d3;border-left:2px;-moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;-moz-box-shadow:2px 2px 2px -2px gray;-webkit-box-shadow:2px 2px 2px -2px gray;box-shadow:2px 2px 2px -2px gray
        
      }
      #findbox_to {
        background: #fff;
        border-radius:.125em;
         
        top:50px;
        margin-bottom: 10px;
        padding: 2px 0;
        width: 220px;
        height: 26px;
        border-style:solid;border-width:1px;border-color:#d3d3d3;border-left:2px;-moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;-moz-box-shadow:2px 2px 2px -2px gray;-webkit-box-shadow:2px 2px 2px -2px gray;box-shadow:2px 2px 2px -2px gray
        
      }
      .search-tooltip {
        width: 200px;

      }
      .leaflet-control-search .search-cancel {
        position: static;
        float: left;
        margin-left: -22px;
      }
     
      .leaflet-control.enabled a {
            background-color: yellow;
      }

     /*  ///////////////Style of  side panel// */
     #tabs_wrapper {
    width: 250px;
}
#tabs_container {
    border-bottom: 1px solid #ccc;
}
#tabs {
    list-style: none;
    padding: 5px 0 4px 0;
    margin: 0 0 0 10px;
    font: 0.75em arial;
}
#tabs li {
    display: inline;
}
#tabs li a {
    border: 1px solid #ccc;
    padding: 4px 6px;
    text-decoration: none;
    background-color: #eeeeee;
    border-bottom: none;
    outline: none;
    border-radius: 5px 5px 0 0;
    -moz-border-radius: 5px 5px 0 0;
    -webkit-border-top-left-radius: 5px;
    -webkit-border-top-right-radius: 5px;
}
#tabs li a:hover {
    background-color: #dddddd;
    padding: 4px 6px;
}
#tabs li.active a {
    border-bottom: 1px solid #fff;
    background-color: #fff;
    padding: 4px 6px 5px 6px;
    border-bottom: none;
}
#tabs li.active a:hover {
    background-color: #eeeeee;
    padding: 4px 6px 5px 6px;
    border-bottom: none;
}
 
#tabs li a.icon_accept {
    background-image: url(accept.png);
    background-position: 5px;
    background-repeat: no-repeat;
    padding-left: 24px;
}
#tabs li a.icon_accept:hover {
    padding-left: 24px;
}
 
#tabs_content_container {
    border: 1px solid #ccc;
    border-top: none;
    padding: 10px;
    width: 200px;
}
.tab_content {
    display: none;
}

.button-0 {
    position: fixed;
    padding: 10px 10px;
    margin-left: 230px;
    margin-bottom: 10px;
    border-radius: 10px;
    font-family: 'Helvetica', cursive;
    font-size: 15px;
    color: #FFF;
    text-decoration: none;  
    background-color: #3498DB;
    border-bottom: 5px solid #2980B9;
    text-shadow: 0px -2px #2980B9;
    /* Animation */
    transition: all 0.1s;
    -webkit-transition: all 0.1s;
}

.button-0:hover, 
.button-0:focus {
    text-decoration: none;
    color: #fff;
}

.button-0:active {
    transform: translate(0px,5px);
    -webkit-transform: translate(0px,5px);
    border-bottom: 1px solid;
}

.button-1 {
    position: fixed;
    padding: 10px 10px;
    margin-left: 50px;
    margin-top: 20px;
    border-radius: 10px;
    font-family: 'Helvetica', cursive;
    font-size: 22px;
    color: #FFF;
    text-decoration: none;  
    background-color: #5CCD00;
    border-bottom: 5px solid #008c00;
    text-shadow: none;
    /* Animation */
    transition: all 0.1s;
    -webkit-transition: all 0.1s;
}

.button-1:hover, 
.button-1:focus {
    text-decoration: none;
    color: #fff;
}

.button-1:active {
    transform: translate(0px,5px);
    -webkit-transform: translate(0px,5px);
    border-bottom: 1px solid;
}

/*////////////////////////*/
    </style>
    <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js" type="text/javascript"></script>
    <script src="../src/leaflet-search.js"></script>
    <script src="data/shp_js/FAC_BLDG.geojson" type="text/javascript"></script>   <!--Converted using http://converter.mygeodata.eu/ , extension changed to .js -->
    <script src="data/shp_js/ACA_BLDG.geojson" type="text/javascript"></script>
    <script src="data/shp_js/BUILDING_OTHERS.js" type="text/javascript"></script>
    <script src="data/shp_js/BUILDING_RES.js" type="text/javascript"></script>
    <script src="data/shp_js/roadline.geojson" type="text/javascript"></script>
    <script src="data/shp_js/SECURITY.js" type="text/javascript"></script>
    <script src="data/shp_js/all_merged.js" type="text/javascript"></script>

    <link rel="stylesheet" href="../../Leaflet.MeasureControl-gh-pages/Leaflet.draw/dist/leaflet.draw.css" />
    <link rel="stylesheet" href="../../Leaflet.MeasureControl-gh-pages/leaflet.measurecontrol.css" />

    <script type="text/javascript" src="myrouting.js"></script>

    <script src="../../Leaflet.MeasureControl-gh-pages/Leaflet.draw/dist/leaflet.draw.js"></script>

    <script src="../../Leaflet.MeasureControl-gh-pages/leaflet.measurecontrol.js"></script>

    <link href='fullscr/leaflet.fullscreen.css' rel='stylesheet' />
    <script src='fullscr/Leaflet.fullscreen.min.js'></script>
    <script src="https://www.mapquestapi.com/sdk/leaflet/v2.s/mq-map.js?key=aLnojtzcFJOuNAd6BxA3uz8pn7PHhrWv"></script>
        <script src="https://www.mapquestapi.com/sdk/leaflet/v2.s/mq-routing.js?key=aLnojtzcFJOuNAd6BxA3uz8pn7PHhrWv"></script>

    <!---->
    <title>IIT Kanpur WebGIS</title>
  </head>
  <body>

    <script src="Print/dist/leaflet.easyPrint.js"></script>
    <script src="Print/dist/jQuery.print.js"></script>

       <H1 style="padding-top:10px;padding-left:50px; font-family: 'Copperplate Gothic Light';
  font-size: 30px;
  font-style: normal;
  font-variant: normal;
  font-weight: bold;
  line-height: 26.4px;"> GEOGRAPHICAL INFORMATION SYSTEM</H1>
       <img src="globe.ico" style=" position:fixed; height:100px;width:100px;left:780px;top:0px;">
       <img src="iitk-logo.png" style="z-index:10000;height:80px;width:400px;position:fixed;top:10px;left:800px;">
<!-- SIDEBAR/////////////// -->
      <div id="sidebar" class="sidebar collapsed">
              <!-- Nav tabs -->
              <div class="sidebar-tabs">
                  <ul role="tablist">
                      <li><a href="#home" role="tab"><i class="fa fa-bars"></i></a></li>
                      <li><a href="#profile" role="tab"><i class="fa fa-search"></i></a></li>
                      <li ><a href="#messages" role="tab"><i class="fa fa-map-marker"></i></a></li>
                  </ul>

                  <ul role="tablist">
                      <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
                  </ul>
              </div>

              <!-- Tab panes -->
              <div class="sidebar-content">
                  <div class="sidebar-pane" id="home">
                      <h1 class="sidebar-header">
                          WELCOME
                          <div class="sidebar-close"><i class="fa fa-caret-left"></i></div>
                      </h1>

                       <p> Welcome to Web GIS for IIT Kanpur.</p><br>
                        <p> You can do the following operations from this portal</p>
                        <ul>
                          <li>Get coordinates of any point</li>
                          <li>Measure perimeter</li>
                          <li>Measure area</li>
                          <li>Draw arbitrary polygons and measure them</li>
                          <li>Search for a feature</li>
                        </ul>
                  </div>

                  <div class="sidebar-pane" id="profile">
                      <h1 class="sidebar-header">Search<div class="sidebar-close"><i class="fa fa-caret-left"></i></div></h1>
                      <!-- <p> Make search query with in the following search boxes.</p>

                      <select id="selectLayer" >
                        <option label=" "></option>
                      <option value="featuresLayer">Facilities</option>
                      <option value="featuresLayer2">Academic Area</option>
                      <option value="featuresLayer3">Residential Area</option>
                      <option value="featuresLayer4">Roads</option>
                      <option value='featuresLayer5'>Security</option>
                      <option value='featuresLayer6'>Other buildings</option>
                    </select>
                    <br/> -->
                      <!-- <button onClick="GetSelectedItem('selectLayer');">Get Selected Item</button> -->
                       <script type="text/javascript">
// function GetSelectedItem(el)
//       {
//           var e = document.getElementById(el);
//           var strSel = "The Value is: " + e.options[e.selectedIndex].value + " and text is: " + e.options[e.selectedIndex].text;
         
         
//           return e.options[e.selectedIndex].value;
//       }
//                       </script>
    
     
                      <div id="findbox"></div>
                      <div id="findbox2"></div>
                      <div id="findbox3"></div>
                  </div>

                  <div class="sidebar-pane" id="messages">
                      <h1 class="sidebar-header">Routing<div class="sidebar-close"><i class="fa fa-caret-left"></i></div></h1>
                      <!-- <button id="findroute">Start Routing</button> -->
                      <div id="findbox_from"></div>
                      
                      <input type="button" id="startbt" class= "button-0" onclick="document.getElementById('endbt').disabled=false;startloc(); return false;" value="Confirm Start" />

                      <div id="findbox_to"></div>
                      
                       <input type="button" id="endbt" class= "button-0" onclick="document.getElementById('startbt').disabled=true;endloc(); return false;" value="Confirm End " />
                       <script type="text/javascript">
                         document.getElementById("endbt").disabled = true;
                       </script>
                      <p> <br></p>
                      <!-- <input name="textbox1" id="textbox1" type="text" /> -->
                      
                     
                      <button class="button-1" onclick="routingfunction(); return false;"><i class="fa fa-car"></i> SHOW ROUTE</button>
                      <div id='route-narrative' style="padding-top: 95px; color: #228B22; font-family:Arial, Helvetica, sans-serif">
                        <p>______________________________________</p>
                      </div>
                      <!-- // <script type="text/javascript"> -->
                      <!-- //   var getcoord = document.getElementById('getcoord');
                      //   getcoord.onClick = function onMapClick(e) {
                      //     var popup = L.popup()
                      //     .setLatLng(e.latlng)
                      //     .setContent("You clicked the map at " + e.latlng)
                      //     .openOn(map);
                          26.50943,80.23397
                      //   }
                      //   map.on('click', onMapClick);
                      // </script> -->
                  </div>


                  <div class="sidebar-pane" id="settings">
                      <h1 class="sidebar-header">Settings<div class="sidebar-close"><i class="fa fa-caret-left"></i></div></h1>
                  </div>
              </div>
          </div>


       <!-- /////////////// -->

       <div id="map" class="sidebar-map"></div>
<div id="route-narrative"></div>
    <script src="sidebar/js/leaflet-sidebar.js"></script>
<!-- 
    <div id="tabs_container">     
    <ul id="tabs">
        <li class="active"><a href="#tab1">Home</a></li>
        <li><a class="icon_accept" href="#tab2">Search</a></li>
        <li><a href="#tab3">Get position</a></li>
    </ul>
    </div>

    <div id="tabs_content_container">
      <div id="tab1" class="tab_content" style="display: block;">
              <p> Welcome to Web GIS for IIT Kanpur.</p><br>
              <p> You can do the following operations from this portal</p>
              <ul>
                <li>Get coordinates of any point</li>
                <li>Measure perimeter</li>
                <li>Measure area</li>
                <li>Draw arbitrary polygons and measure them</li>
                <li>Search for a feature</li>
              </ul>

      </div>
      <div id="tab2" class="tab_content">
        <p> Make search query with in the following search boxes.</p>
          <div id="findbox"></div>
          <div id="findbox2"></div>
          <div id="findbox3"></div>
      </div>
      <div id="tab3" class="tab_content">

        <button onclick="onMapClick(e)">Get coordinates</button>
          <script>
           
            function onMapClick(e) {
            var popup = L.popup()
            .setLatLng(e.latlng)
            .setContent("You clicked the map at " + e.latlng)
            .openOn(map);
          </script>
      </div>
    </div>
    <script type="text/javascript">
    $(document).ready(function(){
          //  When user clicks on tab, this code will be executed
          $("#tabs li").click(function() {
              //  First remove class "active" from currently active tab
              $("#tabs li").removeClass('active');
       
              //  Now add class "active" to the selected/clicked tab
              $(this).addClass("active");
       
              //  Hide all tab content
              $(".tab_content").hide();
       
              //  Here we get the href value of the selected tab
              var selected_tab = $(this).find("a").attr("href");
       
              //  Show the selected tab content
              $(selected_tab).fadeIn();
       
              //  At the end, we add return false so that the click on the link is not executed
              return false;
          });
      });
    </script>
     -->
 
    <!-- div id="search_panel" >
      <select id="selectLayer">
        <option value="featuresLayer">Facilities</option>
        <option value="featuresLayer2">Academic Area</option>
        <option>featuresLayer3</option>
        <option>featuresLayer4</option>
        <option>featuresLayer5</option>
        <option>featuresLayer6</option>
      </select>
      <br/>
        <button onClick="GetSelectedItem('selectLayer');">Get Selected Item</button>
    </div> 
     <script type="text/javascript">
    //   function GetSelectedItem(el)
    //   {
    //        var e = document.getElementById(el);
    //       var strSel = "The Value is: " + e.options[e.selectedIndex].value + " and text is: " + e.options[e.selectedIndex].text;
    //       alert(strSel);
    //   }
    // </script> !-->
    <script src="legend/src/leaflet-panel-layers.js"></script>

    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-geodesy/v0.1.0/leaflet-geodesy.js'></script>
    <script src="mylocation/src/L.Control.Locate.js" ></script>
   

    <script type="text/javascript">
      var basemap = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
      var map = L.map('map', { fullscreenControl: true}).setView([26.50943,80.23397], 15);
      basemap.addTo(map);
      
        // Direction routing ///////////////////
      
      /////////////////////////////////////////

      
      // map.on('click', function (e) {
      //   var popup = L.popup()
      //   .setLatLng(e.latlng)
      //   .setContent(e.latlng)
      //   .openOn(map);
        
      // }
      
      var sidebar = L.control.sidebar('sidebar').addTo(map);
      // add location control to global name space for testing only
      // on a production site, omit the "lc = "!
      lc = L.control.locate({
          follow: true,
          strings: {
              title: "Show me where I am, yo!"
          }
      }).addTo(map);

      map.on('startfollowing', function() {
          map.on('dragstart', lc._stopFollowing, lc);
      }).on('stopfollowing', function() {
          map.off('dragstart', lc._stopFollowing, lc);
      });

      // var circle = L.circle([51.508, -0.11], 500, {
      // color: 'red',
      // fillColor: '#f03',
      // fillOpacity: 0.5}).addTo(map);
      // circle.bindPopup("Well Done, 786!");
      
      
      
      var countryStyle = {
        'color': '#035',
        'weight': 1,
        'opacity': 1
      };

      function popup(feature, layer) {
          feature.layer = layer;
          if (feature.properties) {
              layer.bindPopup("Name: "+feature.properties.Name + "<br>" +
                
                  "ShortName: " + feature.properties.ShortName +"<br>" + "Type: " + feature.properties.Type +"<br>" +
                  "Nature: " + feature.properties.Nature +"<br>" +
                  "Department: " + feature.properties.Department + "<br>" +"Use: " + feature.properties.USE +"<br>" +
                  "Address1: " + feature.properties.Address1 + "<br>" +"Address2: " + feature.properties.Address2 +"<br>" +
                  "Floors: " + feature.properties.Floors +"<br>" +"Construction Year: " + feature.properties.ConstYr +"<br>" +
                  "Area: " + feature.properties.AREA +"<br>" +
                  "Perimeter: " + feature.properties.Shape_Leng +"<br>" +
                  "Geometry: "+feature.geometry.type + "<br>");
          }
      }

// LAYERS //////////////////////////////////

      var data1 = building_fac;
      var featuresLayer = new L.GeoJSON(data1, {

          style: function(feature) {
            return { stroke: false, color: 'green' ,'weight': 1, 'opacity':1 };
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        });


      //map.addLayer(featuresLayer);

      var data2 = building_acad;
      var featuresLayer2 = new L.GeoJSON(data2, {

          style: function(feature) {
            return {  stroke: false,color: 'red','weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        });

      
      //map.addLayer(featuresLayer2);
      
      var data3 = building_res;
      var featuresLayer3 = new L.GeoJSON(data3, {

          style: function(feature) {
            return {  stroke: false,color: 'blue','weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        });

      //map.addLayer(featuresLayer3);

      var data4 = roadline;
      var featuresLayer4 = new L.GeoJSON(data4, {

          style: function(feature) {
            return {  stroke: false,color: 'black' ,'weight': 1, 'opacity':1 };
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        });

      //map.addLayer(featuresLayer4);

      var data5 = security;
      var featuresLayer5 = new L.GeoJSON(data5, {

          style: function(feature) {
            return { stroke: false, color: 'yellow' ,'weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        });

      //map.addLayer(featuresLayer5);

      var data6 = building_oth;
      var featuresLayer6 = new L.GeoJSON(data6, {

          style: function(feature) {
            return { stroke: false, color: 'orange' ,'weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        });

      //map.addLayer(featuresLayer6);
      
      var data_mer = merged;
      // var NewMapCenter = map.getCenter();
      // var latitude = NewMapCenter.lat();
      // var longitude = NewMapCenter.lng();
      var featuresLayer_mer = new L.GeoJSON(data_mer, {

          style: function(feature) {
            return { color: ' black' ,'weight': 0, 'opacity':0};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" +  map.getCenter()+ "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        });
      // TOGGLE LAYERS //////////////////////////
      L.control.layers({
          
          'OpenStreetMap': L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'),
          'Satellite Imagery': L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',{maxZoom:17}),
          'Topographic Map' : L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}'),
          'Street Map':  L.tileLayer('http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {  maxZoom: 19})
          
      }).addTo(map);
//LEGEND///////////////
      function iconByName(name) {
        return '<i class="icon icon-'+name+'"></i>';
      }
    var baseLayers = [
      // {
      //   name: "OpenStreetMap",
      //   layer: L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
      // },
      // { 
      //   name: "Satellite Imagery",
      //   layer: L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',{maxZoom:17})
      // },
      // {
      //   name: "Topographic Map",
      //   layer: L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}')
      // },
      // {
      //   name: "Street Map",
      //   layer: L.tileLayer('http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {  maxZoom: 19})
      // }
    ];
      var overLayers = [
        {
          name: "Facilities",
          icon: iconByName('parking'),
          layer: L.geoJson(building_fac, {

          style: function(feature) {
            return { color: 'green' ,'weight': 1, 'opacity':1 };
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        })
        },

        {
          name: "Academic Area",
          icon: iconByName('bar'),
          layer: L.geoJson(building_acad, {

          style: function(feature) {
            return { color: 'red','weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        })
        },
        {
          name: "Residential area",
          icon: iconByName('drinking_water'),
          layer: L.geoJson(building_res, {

          style: function(feature) {
            return { color: 'blue','weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        })
        },
        {
          name: "Roads",
          icon: iconByName('fuel'),
          layer: L.geoJson(roadline, {

          style: function(feature) {
            return { color: 'black' ,'weight': 1, 'opacity':1 };
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        })
        },

        {
          name: "Security",
          icon: iconByName('fuel'),
          layer: L.geoJson(security, {

          style: function(feature) {
            return { color: 'yellow' ,'weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        })
        } ,

        {
          name: "Others",
          icon: iconByName('fuel'),
          layer: L.geoJson(building_oth, {

          style: function(feature) {
            return { color: 'orange' ,'weight': 1, 'opacity':1};
          },
          onEachFeature: function(feature, marker) {
            marker.bindPopup(L.popup({maxWidth:1000}).setContent('<p><img src="iitk.gif" display="inline" align="center"  width="100%" height="300px">'+"<table  border='0' style='width:100%;border-collapse: collapse;'><tr><td align='center'><a href=http://iitk.ac.in>Visit Homepage</a> </td><td align='center'><a href=https://www.google.co.in/maps/@26.5123599,80.2334403,15.59z>View on Google Maps</a></td><td align='center'><a href=#>View 3d model</a></td></tr></table> <table border='1' style='width:100%;border-collapse: collapse;'><tr><td>Coordinates </td><td>Name </td><td>ShortName </td><td>Type </td><td>Nature </td><td>Department </td><td>Use </td></tr> <tr><td>" + map.getCenter() + "</td><td>" + feature.properties.Name + "</td><td>" + feature.properties.ShortName +"</td><td>" + feature.properties.Type +"</td><td>" +feature.properties.Nature +"</td><td>" + feature.properties.Department + "</td><td>"+ feature.properties.USE +"</td><tr> </table> <br> <table border='1' style='width:100%;border-collapse: collapse;'<tr><td>Address1 </td><td>Address2 </td><td>Floors </td><td>Constr. Year </td><td>Area </td><td>Perimeter </td><td>Geometry </td><tr> <tr><td>"+feature.properties.Address1 + "</td><td>" + feature.properties.Address2 +"</td><td>" + feature.properties.Floors +"</td><td>" + feature.properties.ConstYr +"</td><td>" + feature.properties.AREA +"</td><td>"+ feature.properties.Shape_Leng +"</td><td>"+feature.geometry.type + "</td><tr></table></p>"));
          }
        })
        }   
        
      ];

      var panelLayers = new L.Control.PanelLayers(baseLayers, overLayers, {collapsed: true});

      map.addControl(panelLayers);

        
//SEARCH TOOL //////////////////////////

      
      
     
   var poiLayers = L.layerGroup([featuresLayer,featuresLayer2,featuresLayer3,featuresLayer4,featuresLayer5,featuresLayer6]).addTo(map);
     var searchControl= new L.Control.Search({
        container: 'findbox',
        layer: featuresLayer_mer,
        propertyName: 'Name',
        
        textPlaceholder: 'Search with Name',
        initial: false,
        collapsed: false,
        markerLocation: true,
        callTip: function(text, val) {
      var type = val.layer.feature.properties.Name;
      return '<a href="#" class="'+type+'">'+text+'<b>'+'('+type+')'+'</b></a>';
    }
      }) ;
      map.addControl(searchControl);

      var searchControl= new L.Control.Search({
        container: 'findbox2',
        layer: featuresLayer_mer,
        propertyName: 'ShortName',
        textPlaceholder: 'Search Short Name',
        initial: false,
        collapsed: false,
        markerLocation: true
      }) ;
      map.addControl(searchControl);

      var searchControl= new L.Control.Search({
        container: 'findbox3',
        layer: featuresLayer_mer,
        propertyName: 'Nature',
        textPlaceholder: 'Search with Use',
        initial: false,
        collapsed: false,
        markerLocation: true
      }) ;
      map.addControl(searchControl);

      /// FOR ROUTING/////////////////
     var startCenter;
     var strcent;
     var startlat;
     var startlng;
     var endCenter;
     var endcent;
     var endlat;
     var endlng;
      
     var searchControl= new L.Control.Search({
        container: 'findbox_from',
        layer: featuresLayer_mer,
        propertyName: 'Name',
        
        textPlaceholder: 'Start',
        initial: false,
        collapsed: false,
        markerLocation: true,
        
      }) ;
      map.addControl(searchControl);
      function startloc(){
          startCenter = map.getCenter();
    
          var str=String(startCenter);
          strcent = str.match(/[+-]?\d+(\.\d+)?/g); //     /\d+/g);
          startlat = strcent[0];
          startlng = strcent[1];
          //alert(strcent[0]);

          //return [startlat, startlng];
      };

       var searchControl= new L.Control.Search({
          container: 'findbox_to',
          layer: featuresLayer_mer,
          propertyName: 'Name',
          
          textPlaceholder: 'End',
          initial: false,
          collapsed: false,
          markerLocation: true,
          
        }) ;
        map.addControl(searchControl);

      function endloc(){ 
         endCenter = map.getCenter();
         var str=String(endCenter);
           endcent = str.match(/[+-]?\d+(\.\d+)?/g); //     /\d+/g);
           endlat = endcent[0];
           endlng = endcent[1];

          // alert(endlat);
          // alert(endlng);

          // var endlat = endCenter.lat();
          // var endlng = endCenter.lng();
          //return [endlat, endlng];
      };
      

                  
      function routingfunction(){
          // var startcoord=startloc();
          // var endcoord=endloc();
          // var startlat = startcoord[0];
          // var startlng = startcoord[1];
          
          // var endlat = endcoord[0];
          // var endlng = endcoord[1];
          var dir;
          dir = MQ.routing.directions()
          .on('success', function(data) {
            var legs = data.route.legs,
                html = '',
                maneuvers,
                i;

            if (legs && legs.length) {
                maneuvers = legs[0].maneuvers;

                for (i=0; i < maneuvers.length; i++) {
                    html +=  '<i class="fa fa-space-shuttle"></i>';
                    html += maneuvers[i].narrative + '<br>';
                }

                L.DomUtil.get('route-narrative').innerHTML = html;
            }
          });

          dir.route({
              locations: [
                  { latLng: { lat: startlat, lng: startlng} },
                   { latLng: { lat: endlat, lng: endlng} }
              ]
          });

          // map.addLayer(MQ.routing.routeLayer({
          //     directions: dir,
          //     fitBounds: true
          // }));

          CustomRouteLayer = MQ.Routing.RouteLayer.extend({
            
          });

          map.addLayer(new CustomRouteLayer({
            directions: dir,
            fitBounds: true,
            draggable: true,
            ribbonOptions: {
              draggable: true,
              ribbonDisplay: { color: '#CC0000', opacity: 1 },
              widths: [10]
            }
          }));

        };
       

      // var poiLayers = L.layerGroup([
      //   featuresLayer,featuresLayer2,featuresLayer3,featuresLayer4,featuresLayer5,featuresLayer6
      // ]);
      //var ans=document.getElementById("selectLayer");

     //  var e = document.getElementById(selectLayer);
     //  var searchControl = new L.Control.Search({layer:featuresLayer, propertyName: 'Name', circleLocation:true,
     //                                            textPlaceholder: 'Search in '+e, markerLocation: false});

     //  searchControl.on('search_locationfound', function(e) {
        
     //    e.layer.setStyle({fillColor: '#3f0', color: '#0f0'});
     //    if(e.layer._popup)
     //      e.layer.openPopup();

     //  }).on('search_collapsed', function(e) {

     //    featuresLayer.eachLayer(function(layer) { //restore feature color
     //      featuresLayer.resetStyle(layer);
     //    }); 
     //  });
      
     //  map.addControl( searchControl );  //inizialize search control
     
     // lr=featuresLayer2
     //  var searchControl2 = new L.Control.Search({layer: lr, propertyName: 'Name', circleLocation:true,
     //                                            textPlaceholder: 'Search in Facilities...', markerLocation: false});

     //  searchControl2.on('search_locationfound', function(e) {
        
     //    e.layer.setStyle({fillColor: '#3f0', color: '#0f0'});
     //    if(e.layer._popup)
     //      e.layer.openPopup();

     //  }).on('search_collapsed', function(e) {

     //    featuresLayer.eachLayer(function(layer) { //restore feature color
     //      featuresLayer.resetStyle(layer);
     //    }); 
     //  });
      
     //  map.addControl( searchControl2 );  //inizialize search control

     //  $('#textsearch').on('keyup', function(e) {

     //      searchControl.searchText( e.target.value );

     //  })
// END SEARCH TOOL ----------------------


// START MEASURE TOOLS /////////////////
      L.Control.measureControl().addTo(map);

      var featureGroup = L.featureGroup().addTo(map);

      var drawControl = new L.Control.Draw({
        edit: {
          featureGroup: featureGroup,
          remove: true
        },
        draw: {
          polyline: false,
          polygon: {
            allowIntersection: false,
            showArea: true,
            drawError: {
              color: '#b00b00',
              timeout: 1000
            },
            shapeOptions: {
              color: '#bada55'
            }
          },
          circle: {
            shapeOptions: {
              color: '#662d91'
            }
          },
          marker: false
        }
      }).addTo(map);

      map.on('draw:created', showPolygonArea);
      map.on('draw:edited', showPolygonAreaEdited);

      function showPolygonAreaEdited(e) {
        e.layers.eachLayer(function(layer) {
          showPolygonArea({ layer: layer });
        });
      }
      function showPolygonArea(e) {
        featureGroup.clearLayers();
        featureGroup.addLayer(e.layer);
        e.layer.bindPopup((LGeo.area(e.layer)).toFixed(2) + ' m<sup>2</sup>');
        e.layer.openPopup();

        
      }
//END MEASURE TOOLS --------------------
//PRINT TOOL
      L.easyPrint().addTo(map)

      
    </script>



  </body>
</html>